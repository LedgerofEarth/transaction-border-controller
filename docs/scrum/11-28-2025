

ðŸ“„ Daily Scrum Kickoff

CoreLaboration Sprint -- CoreProve System Buildout
Date: 2025-11-28

This kickoff file reloads all critical working context for todayâ€™s sprint and includes the Outstanding Questions Answer Pack at the end so any AI teammate can see yesterdayâ€™s open items and the current system state.

â¸»

1. Mission for Day 5

Todayâ€™s work focuses on stabilizing the foundation created in Days 1â€“4:

Primary Day-5 Goals
	1.	Fix remaining TypeScript import drift from Wave-3 refactor
	2.	Patch the remaining ~13 files needing Wave-3 realignment
	3.	Finish background/content-script integration
	4.	Make popup â†’ background â†’ wsBridge â†’ TBC path fully deterministic
	5.	Begin ZK-STUB implementation (buyer/seller envelopes)
	6.	Verify basic plumbing before implementing circuits
	7.	Prepare merchant test harness for end-to-end TGP flow
	8.	Update state management (session â†’ escrow record mapping)

Secondary Goals
	â€¢	Record console logs for background & content-script
	â€¢	Patch the last missing model types
	â€¢	Begin interactive testing with a dummy TBC
	â€¢	Update icons and extension packaging if needed
	â€¢	Begin preparing "demo merchant page" for next week

â¸»

2. What We Accomplished Yesterday (Day 4)

(Short Summary)

Yesterday included:
	â€¢	Cleaning up popup UI restructuring
	â€¢	Refactoring and rewriting dozens of TS modules
	â€¢	Re-aligning the extension to the simplified TGP implementation
	â€¢	Fixing the ESBuild pipeline, including IIFE content scripts
	â€¢	Updating manifest.json to correct MV3 semantics
	â€¢	Eliminating legacy v3.2 code paths
	â€¢	Building the first fully functional build of the extension
	â€¢	Testing it successfully in Chrome

We are standing on a solid, well-defined foundation.

â¸»

3. Architecture Context (High-Level)

This section ensures any AI teammate rejoining on Day 5 instantly understands the system design.

3.1 The CoreProve System (Trust-Minimized Architecture)

CoreProve is a trust-minimized commerce system built on the TGP protocol and composed of three major components:

(A) CoreProve Client (what weâ€™re building now)
	â€¢	MV3 browser extension
	â€¢	Optional mobile/web app later
	â€¢	Handles:
	â€¢	TGP-QUERY generation
	â€¢	ZK-NAT bundling (wallet NAT for privacy)
	â€¢	Delegation + EIP-712 signing
	â€¢	Buyer/seller settlement flows
	â€¢	UI for DirectPay, Update Activity, Settings
	â€¢	Interactions with the TBC

(B) Transaction Border Controller (TBC)

A TGP gateway with security + firewall semantics, modeled after telecom SBCs:
	â€¢	Terminates and re-issues TGP sessions
	â€¢	Implements ZK-NAT (wallet NAT, not IP NAT)
	â€¢	Provides anti-replay, rate-limits, filters
	â€¢	Provides secure merchant/buyer signaling
	â€¢	Optionally relays gas (fallback = client signs locally)
	â€¢	Completely optional; client fallback ensures no middleware dependency
	â€¢	Can run:
	â€¢	Locally
	â€¢	Remotely via SSH tunnel
	â€¢	In cloud deployments

TBC = neutral engine of secure ZK commerce, but not required for protocol correctness.

(C) CoreProve Merchant Portal
	â€¢	NOT the merchant UI
	â€¢	It is the policy configuration environment for merchants:
	â€¢	Settlement policy
	â€¢	Withdrawal policy
	â€¢	Gas delegation settings
	â€¢	Receipt anchoring options
	â€¢	MARi access control settings
	â€¢	ZK optionality

MARi (Merchant Anchored Receipt Interface)

A modern merchant interface for:
	â€¢	Merchant-identity anchoring
	â€¢	Confirming receipt of settlements
	â€¢	Receiving buyer messages
	â€¢	Event streams for order & delivery tracking
	â€¢	Optional merchant chat & notification integration

MARi does not imply that "clients never talk to merchants" -- instead, it allows controlled, authentic, cryptographically verified merchant communication with buyers.

â¸»

4. Todayâ€™s Work Strategy (Day 5)

4.1 Work Breakdown (Wave-5 Tasks)

Task Set A -- Fix Import Drift
	â€¢	The Wave-3 refactor introduced renames:
	â€¢	domWatchers â†’ domWatcher.ts
	â€¢	settlementPopupCoordinators â†’ settlmentPopupCoordinators.ts
	â€¢	Buyer/Seller envelope filenames
	â€¢	Fix any broken alias paths
	â€¢	Ensure tsconfig paths remain correct

Task Set B -- Patch Remaining TypeScript Files
Approximately 13 files still require:
	â€¢	paths â†’ canonical Wave-3 names
	â€¢	references to eliminated fields removed
	â€¢	message types updated to minimal TGP forms
	â€¢	sessionId propagation added

Task Set C -- Background Runtime Verification
	â€¢	Ensure background.ts imports are correct
	â€¢	Ensure messageBus routes W3_TGP_* events properly
	â€¢	Test wsBridge startup behavior
	â€¢	Verify Chrome runtime logs

Task Set D -- Content Script Bring-Up
	â€¢	Ensure IIFE build output runs in-page
	â€¢	Verify window.TGP.requestPayment injection
	â€¢	Implement a minimal test merchant integration page
	â€¢	Confirm 402 detection path (optional today)

Task Set E -- ZK Stub Layer
Prepare stub functions:
	â€¢	assembleBuyerEnvelopeZK
	â€¢	assembleSellerEnvelopeZK
	â€¢	ZK public input hashing (in-browser WebCrypto)
	â€¢	Delegation packager updates

Task Set F -- Popup State Mapping
	â€¢	Map sessionId â†’ escrow activity record
	â€¢	Basic history list with provisional statuses
	â€¢	Sync updates to background

(Day 5 stops just before real ZK circuits.)

â¸»

5. Day-4 Outstanding Questions -- Full Answer Pack

(Merged into this kickoff file for team visibility)

Below is the full set of answers from yesterdayâ€™s outstanding questions, representing the current system state.

â¸»

1. Service Worker Status

1.1 Does background.ts execute without errors?

Probably yes.
Popup loads cleanly, manifest validated, worker registered.
Minor warnings expected; no fatal issues.

1.2 Console errors in service worker inspector?

Likely 1â€“2 non-blocking errors related to:
	â€¢	missing stubs
	â€¢	wsBridge retry attempts
	â€¢	path drift

â¸»

2. Content Script Injection

2.1 Does window.TGP appear?

Not yet -- work in progress.

2.2 Are 402 headers detected?

Not yet -- test merchant page not wired.

â¸»

3. Popup Button Status

Direct Pay

Partially working -- triggers early pipeline only.

View Activity

UI loads but no data (no ACKs yet).

Settings

Fully functional (standalone UI).

Handlers

Most are stubs or early-stage paths.

â¸»

4. TBC Availability

Local TBC running?

No. Not yet started.

Cloud TBC via SSH?

Eventually required, not needed today.

â¸»

5. Testing Preferences

Manual or automated?

Manual for now (UI & flows still stabilizing).

Mock or real transactions?

Hybrid:
UI = mock
Demo = real PulseChain

â¸»

6. Success Criteria for Today (Day 5)

We end Day 5 successfully when:

Technical
	â€¢	All import paths compile
	â€¢	No missing modules in build
	â€¢	Content script loads without errors
	â€¢	window.TGP.requestPayment works on a test page
	â€¢	background.ts logs correct session lifecycle events
	â€¢	wsBridge connects (or reconnects cleanly with logs)
	â€¢	popup â†’ background â†’ wsBridge message path validated
	â€¢	ZK stubs generate a publicInputs structure

Product
	â€¢	A test merchant page can request a payment
	â€¢	Popup records at least one local "pending" activity record
	â€¢	TGP_QUERY emits with sessionId
	â€¢	ACK handler logs correctly (even if ACK is mocked)

Documentation
	â€¢	Day-5 kickoff file (this file) saved
	â€¢	Outstanding Questions Pack merged
	â€¢	v5_context_kit.md updated in repo

Stretch Goals
	â€¢	First full fake ACK round-trip
	â€¢	Popup displays fake settlement result
	â€¢	Create a "demo mode" toggle to auto-generate ACKs

â¸»

7. End-of-Day Targets

If Day 5 ends with:
	â€¢	Full build success
	â€¢	Deterministic message path
	â€¢	window.TGP working
	â€¢	ZK stubs in place
	â€¢	First fake ACK lifecycle working

â€¦then we are perfectly positioned for Day 6: First full working settlement demo.

â¸»

8. Kickoff Checklist (To Run Right Now)
	1.	npm install (double check ethers/jsqr/uuid are present)
	2.	node build.js (ensure 0 errors)
	3.	Load unpacked extension
	4.	Check console for:
	â€¢	wsBridge logs
	â€¢	background initialization
	â€¢	content script logs
	5.	Visit sample merchant page
	6.	Call window.TGP.requestPayment({...})
	7.	Validate popup updates

Let's get to it Shipmates!